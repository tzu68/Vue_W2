import{_ as M,r as v,b as F,d as x,c as a,h as _,t as i,a as t,f as m,g as T,e as r,F as C,i as H,w as L,v as V,j as k,o as c,p as R,k as U}from"./index-BH4JOndM.js";import{a as b}from"./axios-DTyqpfTh.js";const l=w=>(R("data-v-d6c7f55d"),w=w(),U(),w),j=l(()=>t("h6",null,"token",-1)),E=l(()=>t("hr",null,null,-1)),q=l(()=>t("h6",null,"addContent",-1)),G=l(()=>t("hr",null,null,-1)),J=l(()=>t("h6",null,"temp:",-1)),K=l(()=>t("hr",null,null,-1)),O=l(()=>t("h6",null,"todoLists:",-1)),P=l(()=>t("hr",null,null,-1)),Q={class:"container-fluid"},W={key:0,class:"row"},X={class:"col-12 text-center"},Y={class:"btn btn-dark",type:"button"},Z={class:"row"},tt={class:"col-12"},et={class:"table table-success table-striped table-hover"},ot=l(()=>t("thead",null,[t("tr",null,[t("th",{scope:"col"},[t("p",null,"ID")]),t("th",{scope:"col"},[t("p",null,"內容")]),t("th",{scope:"col"},[t("p",null,"動作")]),t("th",{scope:"col"},[t("p",null,"建立時間")]),t("th",{scope:"col"},[t("p",null,"是否完成")])])],-1)),nt={key:"{{item.id}}"},st={class:""},lt={class:"w-25"},at={key:1},ct=["onClick"],ut=["onClick"],dt=["checked","onClick"],it={class:"w-25"},rt=l(()=>t("td",null,null,-1)),pt=l(()=>t("td",null,null,-1)),ht=l(()=>t("td",null,null,-1)),vt={__name:"TodoListView",setup(w){const $=v(!1),d=v(""),p=v("https://todolist-api.hexschool.io"),y=v(""),g=v(""),s=v({id:"",createTime:0,content:"",status:!1});F(async()=>{await I(),$&&await f()});async function I(){try{d.value=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*\=\s*([^;]*).*$)|^.*$/,"$1");const o=`${p.value}/users/checkout`;(await b.get(o,{headers:{Authorization:d.value}})).status==200&&($.value=!0)}catch(o){console.log("Token檢查失敗",o)}}async function f(){const o=`${p.value}/todos/`;try{const e=await b.get(o,{headers:{Authorization:d.value}});e.status==200&&(y.value=e.data.data)}catch(e){console.log("取得TodoList失敗",e)}}async function z(){const o=`${p.value}/todos/`;try{const e=await b.post(o,{content:g.value},{headers:{Authorization:d.value}})}catch(e){console.log("新增失敗",e)}await f()}function A(o){const e=y.value.findIndex(u=>u.id==o);s.value={...y.value[e]}}async function N(){const o=`${p.value}/todos/${s.value.id}`;try{const e=await b.put(o,{content:s.value.content},{headers:{Authorization:d.value}})}catch(e){console.log("更新失敗",e)}s.value={},await f()}async function S(o){const e=`${p.value}/todos/${o}`;try{const u=await b.delete(e,{headers:{Authorization:d.value}})}catch(u){console.log("刪除失敗",u)}s.value={},await f()}async function B(o){const e=`${p.value}/todos/${o}/toggle`;try{const u=await b.patch(e,{},{headers:{Authorization:d.value}})}catch(u){console.log("更新toggle失敗",u)}await f()}return(o,e)=>{const u=x("H1"),D=x("RouterLink");return c(),a(C,null,[j,_(" "+i(d.value)+" ",1),E,q,_(" "+i(g.value)+" ",1),G,J,_(" "+i(s.value)+" ",1),K,O,_(" "+i(y.value)+" ",1),P,t("div",Q,[$.value?r("",!0):(c(),a("div",W,[t("div",X,[m(u,null,{default:T(()=>[_("尚未登入")]),_:1}),t("button",Y,[m(D,{class:"nav-link",to:"/Login"},{default:T(()=>[_("返回登入頁面")]),_:1})])])])),t("div",Z,[t("div",tt,[t("table",et,[ot,t("tbody",null,[(c(!0),a(C,null,H(y.value,(n,_t)=>(c(),a("tr",nt,[t("td",st,[t("p",null,i(n.id),1)]),t("td",lt,[s.value.id===n.id?L((c(),a("input",{key:0,type:"text","onUpdate:modelValue":e[0]||(e[0]=h=>s.value.content=h)},null,512)),[[V,s.value.content]]):r("",!0),s.value.id!==n.id?(c(),a("p",at,i(n.content),1)):r("",!0)]),t("td",null,[s.value.id!==n.id?(c(),a("button",{key:0,class:"btn btn-success d-inline-block me-md-1",type:"button",onClick:k(h=>A(n.id),["prevent"])}," 編輯 ",8,ct)):r("",!0),s.value.id!==n.id?(c(),a("button",{key:1,class:"btn btn-danger d-inline-block",type:"button",onClick:k(h=>S(n.id),["prevent"])}," 刪除 ",8,ut)):r("",!0),s.value.id===n.id?(c(),a("button",{key:2,class:"btn btn-success d-inline-block me-md-1",type:"button",onClick:e[1]||(e[1]=k(h=>N(),["prevent"]))}," 確認 ")):r("",!0),s.value.id===n.id?(c(),a("button",{key:3,class:"btn btn-secondary d-inline-block",type:"button",onClick:e[2]||(e[2]=k(h=>s.value={},["prevent"]))}," 取消 ")):r("",!0)]),t("td",null,[t("p",null,i(n.createTime),1)]),t("td",null,[t("input",{type:"checkbox",name:"",checked:n.status,onClick:k(h=>B(n.id),["prevent"])},null,8,dt)])]))),128)),t("tr",null,[t("td",it,[L(t("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=n=>g.value=n),placeholder:"請輸入要新增的內容"},null,512),[[V,g.value]])]),t("td",null,[t("button",{class:"btn btn-success d-inline-block",type:"button",onClick:e[4]||(e[4]=k(n=>z(),["prevent"]))}," 新增 ")]),rt,pt,ht])])])])])])],64)}}},yt=M(vt,[["__scopeId","data-v-d6c7f55d"]]);export{yt as default};
