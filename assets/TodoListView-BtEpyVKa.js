import{r as h,i as D,f as _,c as a,b as t,a as $,w as x,e as r,F as M,j as F,d as T,v as C,k as b,g as m,o as c,h as L,t as g,p as H,l as R}from"./index-CCMbNEXF.js";const U=(d,k)=>{const l=d.__vccOpts||d;for(const[i,p]of k)l[i]=p;return l},f=d=>(H("data-v-8bb436b9"),d=d(),R(),d),j={class:"container-fluid"},E={key:0,class:"row"},O={class:"col-12 text-center"},q={class:"btn btn-dark",type:"button"},G={class:"row"},J={class:"col-12"},K={class:"table table-success table-striped table-hover"},P=f(()=>t("thead",null,[t("tr",null,[t("th",{scope:"col"},[t("p",null,"ID")]),t("th",{scope:"col"},[t("p",null,"內容")]),t("th",{scope:"col"},[t("p",null,"動作")]),t("th",{scope:"col"},[t("p",null,"建立時間")]),t("th",{scope:"col"},[t("p",null,"是否完成")])])],-1)),Q={key:"{{item.id}}"},W={class:""},X={class:"w-25"},Y={key:1},Z=["onClick"],tt=["onClick"],et=["checked","onClick"],ot={class:"w-25"},nt=f(()=>t("td",null,null,-1)),st=f(()=>t("td",null,null,-1)),lt=f(()=>t("td",null,null,-1)),at={__name:"TodoListView",setup(d){const k=h(!1),l=h(""),i=h("https://todolist-api.hexschool.io"),p=h(""),w=h(""),s=h({id:"",createTime:0,content:"",status:!1});D(async()=>{await V(),k&&await y()});async function V(){try{l.value=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*\=\s*([^;]*).*$)|^.*$/,"$1");const o=`${i.value}/users/checkout`;(await _.get(o,{headers:{Authorization:l.value}})).status==200&&(k.value=!0)}catch(o){console.log("Token檢查失敗",o)}}async function y(){const o=`${i.value}/todos/`;try{const e=await _.get(o,{headers:{Authorization:l.value}});e.status==200&&(p.value=e.data.data)}catch(e){console.log("取得TodoList失敗",e)}}async function I(){const o=`${i.value}/todos/`;try{const e=await _.post(o,{content:w.value},{headers:{Authorization:l.value}})}catch(e){console.log("新增失敗",e)}await y()}function z(o){const e=p.value.findIndex(u=>u.id==o);s.value={...p.value[e]}}async function A(){const o=`${i.value}/todos/${s.value.id}`;try{const e=await _.put(o,{content:s.value.content},{headers:{Authorization:l.value}})}catch(e){console.log("更新失敗",e)}s.value={},await y()}async function N(o){const e=`${i.value}/todos/${o}`;try{const u=await _.delete(e,{headers:{Authorization:l.value}})}catch(u){console.log("刪除失敗",u)}s.value={},await y()}async function S(o){const e=`${i.value}/todos/${o}/toggle`;try{const u=await _.patch(e,{},{headers:{Authorization:l.value}})}catch(u){console.log("更新toggle失敗",u)}await y()}return(o,e)=>{const u=m("H1"),B=m("RouterLink");return c(),a("div",j,[k.value?r("",!0):(c(),a("div",E,[t("div",O,[$(u,null,{default:x(()=>[L("尚未登入")]),_:1}),t("button",q,[$(B,{class:"nav-link",to:"/Login"},{default:x(()=>[L("返回登入頁面")]),_:1})])])])),t("div",G,[t("div",J,[t("table",K,[P,t("tbody",null,[(c(!0),a(M,null,F(p.value,(n,ct)=>(c(),a("tr",Q,[t("td",W,[t("p",null,g(n.id),1)]),t("td",X,[s.value.id===n.id?T((c(),a("input",{key:0,type:"text","onUpdate:modelValue":e[0]||(e[0]=v=>s.value.content=v)},null,512)),[[C,s.value.content]]):r("",!0),s.value.id!==n.id?(c(),a("p",Y,g(n.content),1)):r("",!0)]),t("td",null,[s.value.id!==n.id?(c(),a("button",{key:0,class:"btn btn-success d-inline-block me-md-1",type:"button",onClick:b(v=>z(n.id),["prevent"])}," 編輯 ",8,Z)):r("",!0),s.value.id!==n.id?(c(),a("button",{key:1,class:"btn btn-danger d-inline-block",type:"button",onClick:b(v=>N(n.id),["prevent"])}," 刪除 ",8,tt)):r("",!0),s.value.id===n.id?(c(),a("button",{key:2,class:"btn btn-success d-inline-block me-md-1",type:"button",onClick:e[1]||(e[1]=b(v=>A(),["prevent"]))}," 確認 ")):r("",!0),s.value.id===n.id?(c(),a("button",{key:3,class:"btn btn-secondary d-inline-block",type:"button",onClick:e[2]||(e[2]=b(v=>s.value={},["prevent"]))}," 取消 ")):r("",!0)]),t("td",null,[t("p",null,g(n.createTime),1)]),t("td",null,[t("input",{type:"checkbox",name:"",checked:n.status,onClick:b(v=>S(n.id),["prevent"])},null,8,et)])]))),128)),t("tr",null,[t("td",ot,[T(t("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=n=>w.value=n),placeholder:"請輸入要新增的內容"},null,512),[[C,w.value]])]),t("td",null,[t("button",{class:"btn btn-success d-inline-block",type:"button",onClick:e[4]||(e[4]=b(n=>I(),["prevent"]))}," 新增 ")]),nt,st,lt])])])])])])}}},it=U(at,[["__scopeId","data-v-8bb436b9"]]);export{it as default};
